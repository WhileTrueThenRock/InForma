<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="mobileAppTest.Views.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:accordion="clr-namespace:Syncfusion.Maui.Accordion;assembly=Syncfusion.Maui.Expander"
    xmlns:buttons="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
    xmlns:cal="clr-namespace:Plugin.Maui.Calendar.Controls;assembly=Plugin.Maui.Calendar"
    xmlns:datagrid="clr-namespace:Syncfusion.Maui.DataGrid;assembly=Syncfusion.Maui.DataGrid"
    xmlns:models="clr-namespace:mobileAppTest.Models"
    xmlns:services="clr-namespace:mobileAppTest.Services"
    xmlns:syncfusion="clr-namespace:Syncfusion.Maui.Expander;assembly=Syncfusion.Maui.Expander"
    xmlns:tabView="clr-namespace:Syncfusion.Maui.TabView;assembly=Syncfusion.Maui.TabView"
    xmlns:viewmodels="clr-namespace:mobileAppTest.ViewModels"
    x:Name="mainpage"
    x:DataType="viewmodels:MainViewModel"
    BindingContext="{viewmodels:MainViewModel}"
    Loaded="thisPage_Loaded"
    NavigationPage.HasNavigationBar="False">

    <tabView:SfTabView x:Name="tabView" TabBarPlacement="Bottom">
        <tabView:SfTabView.Items>
            <!--  TAB NUMBER ONE  -->
            <tabView:SfTabItem Header="Calendar">
                <tabView:SfTabItem.Content>
                    <ScrollView>
                        <VerticalStackLayout Padding="10,0" Spacing="25">
                            <HorizontalStackLayout Margin="0,50,0,0">
                                <Label
                                    FontAttributes="Bold,Italic"
                                    HorizontalOptions="Center"
                                    Text="Hello "
                                    TextColor="Black" />
                                <Label
                                    Margin="10,0,0,0"
                                    Text="{Binding UserName}"
                                    TextColor="Red" />
                            </HorizontalStackLayout>

                            <cal:Calendar
                                Culture="{Binding Culture}"
                                Events="{Binding Events, Mode=TwoWay}"
                                HeaderSectionVisible="True"
                                HeightRequest="400"
                                SelectedDate="{Binding Exercise.FechaEntrenamiento}"
                                SelectedDateColor="Orange"
                                SelectedDayBackgroundColor="Green"
                                SelectedDayEvents="{Binding EventsList, Mode=TwoWay}"
                                ShowYearPicker="False"
                                TodayOutlineColor="Aqua"
                                WidthRequest="350" />
                            <Border>
                                <CollectionView
                                    x:Name="myCalendarCollection"
                                    HeightRequest="300"
                                    ItemsSource="{Binding EventsList}"
                                    SelectedItem="{Binding ExerciseView, Mode=TwoWay}"
                                    SelectionMode="Single">
                                    <CollectionView.ItemTemplate>
                                        <DataTemplate x:DataType="models:ExerciseModelView">
                                            <Border>
                                                <Grid>
                                                    <Grid.GestureRecognizers>
                                                        <TapGestureRecognizer Command="{Binding Source={x:Reference myCalendarCollection}, Path=BindingContext.ExerciseTappedCommand}" CommandParameter="{Binding}" />
                                                    </Grid.GestureRecognizers>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Label
                                                        Grid.Row="1"
                                                        Text="{Binding Name}"
                                                        TextColor="Black"
                                                        VerticalOptions="Center" />
                                                    <!--<Label Text="{Binding Path=BindingContext.TotalWorkoutDurationLabel, Source={x:Reference mainpage}}" />-->
                                                    <Image
                                                        Grid.Row="1"
                                                        Margin="160,0,0,0"
                                                        HeightRequest="100"
                                                        Source="{Binding Urls[0]}"
                                                        WidthRequest="200" />
                                                    <CheckBox
                                                        Grid.Row="1"
                                                        Grid.Column="3"
                                                        HeightRequest="50"
                                                        IsChecked="{Binding IsChecked}" />
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>
                                </CollectionView>
                            </Border>
                            <VerticalStackLayout Margin="0,20,0,0">
                                <HorizontalStackLayout HorizontalOptions="Center" Spacing="20">
                                    <Button
                                        Background="Red"
                                        Command="{Binding DeleteSelectedEventCommand}"
                                        IsVisible="{Binding IsDeleteExerciseButtonVisible}"
                                        Text="Borrar"
                                        WidthRequest="100" />
                                    <Button
                                        Background="GreenYellow"
                                        Command="{Binding BindingContext.OpenInfoExercisePopupCommand, Source={x:Reference myCalendarCollection}}"
                                        IsVisible="{Binding IsDetailsExerciseButtonVisible}"
                                        Text="Detalles"
                                        TextColor="Black"
                                        WidthRequest="150" />
                                </HorizontalStackLayout>

                            </VerticalStackLayout>

                        </VerticalStackLayout>
                    </ScrollView>
                </tabView:SfTabItem.Content>
            </tabView:SfTabItem>
            <!--  TAB NUMBER TWO  -->
            <tabView:SfTabItem Header="Gym">
                <tabView:SfTabItem.Content>

                    <ScrollView>
                        <VerticalStackLayout Margin="10">
                            <ScrollView Orientation="Horizontal">
                                <HorizontalStackLayout>

                                    <VerticalStackLayout>
                                        <Border
                                            BackgroundColor="Orange"
                                            StrokeShape="RoundRectangle 0,20,20,0"
                                            StrokeThickness="2">
                                            <syncfusion:SfExpander
                                                x:Name="durationExpander"
                                                Margin="10,10,0,0"
                                                IsExpanded="{Binding DurationExpander}"
                                                WidthRequest="100">
                                                <syncfusion:SfExpander.Header>
                                                    <Grid>
                                                        <Label HeightRequest="40" Text="{Binding DurationHeader}" />
                                                    </Grid>
                                                </syncfusion:SfExpander.Header>
                                                <syncfusion:SfExpander.Content>
                                                    <Grid>
                                                        <buttons:SfRadioGroup>
                                                            <Label Text="Tiempo de entrenamiento" />

                                                            <buttons:SfRadioButton IsChecked="True" Text="15 min">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="15"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>

                                                            <buttons:SfRadioButton Text="30 min">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="30"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>

                                                            <buttons:SfRadioButton Text="45 min">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="45"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>

                                                            <buttons:SfRadioButton Text="1 hr">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="60"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>

                                                            <buttons:SfRadioButton Text="1:30 hr">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="90"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>

                                                            <buttons:SfRadioButton Text="2 hr">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="120"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>

                                                            <buttons:SfRadioButton Text="2:30 hr">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="150"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>

                                                            <buttons:SfRadioButton Text="3 hr">
                                                                <buttons:SfRadioButton.GestureRecognizers>
                                                                    <TapGestureRecognizer
                                                                        Command="{Binding SelectDurationWorkoutCommand}"
                                                                        CommandParameter="180"
                                                                        NumberOfTapsRequired="1" />
                                                                </buttons:SfRadioButton.GestureRecognizers>
                                                            </buttons:SfRadioButton>
                                                        </buttons:SfRadioGroup>
                                                    </Grid>
                                                </syncfusion:SfExpander.Content>
                                            </syncfusion:SfExpander>
                                        </Border>
                                    </VerticalStackLayout>
                                    <!--<HorizontalStackLayout Margin="130,-40,0,0">-->
                                    <Button
                                        Margin="10,10,10,0"
                                        Command="{Binding OpenMuscleSelectionPopupCommand}"
                                        HeightRequest="40"
                                        HorizontalOptions="Start"
                                        Text="Músculos"
                                        VerticalOptions="Start"
                                        WidthRequest="110" />

                                    <Button
                                        Margin="10,10,10,0"
                                        Command="{Binding OpenEquipmentPopupCommand}"
                                        HeightRequest="40"
                                        HorizontalOptions="Start"
                                        Text="Equipamiento"
                                        VerticalOptions="Start"
                                        WidthRequest="110" />
                                    <Button
                                        Margin="20,10,10,0"
                                        Command="{Binding OpenCustomExercisePopupCommand}"
                                        HeightRequest="40"
                                        Text="Custom"
                                        VerticalOptions="Start"
                                        WidthRequest="100" />
                                </HorizontalStackLayout>
                            </ScrollView>
                            <HorizontalStackLayout>
                                <Label
                                    Margin="10,0,0,0"
                                    FontAttributes="Bold"
                                    FontFamily="Calibri"
                                    FontSize="20"
                                    Text="{Binding ExerciseCount}"
                                    TextColor="Red" />
                                <Label
                                    Margin="10,0,0,0"
                                    FontAttributes="Bold"
                                    FontFamily="Calibri"
                                    FontSize="20"
                                    Text="Ejercicios" />
                            </HorizontalStackLayout>
                            <ScrollView>

                                <CollectionView
                                    x:Name="myCollectionView"
                                    HeightRequest="500"
                                    ItemsSource="{Binding ExerciseList}">
                                    <CollectionView.ItemTemplate>
                                        <DataTemplate x:DataType="models:ExerciseModelView">


                                            <SwipeView>
                                                <!--<SwipeView.GestureRecognizers>
                                                <SwipeGestureRecognizer
                                                Command="{Binding Source={x:Reference thisPage}, Path=BindingContext.DeleteSwipedRowCommand}"
                                                CommandParameter="{Binding .}"
                                                Direction="Right" />
                                                </SwipeView.GestureRecognizers>-->

                                                <SwipeView.LeftItems>
                                                    <SwipeItems>
                                                        <SwipeItem
                                                            BackgroundColor="Red"
                                                            Command="{Binding Source={x:Reference mainpage}, Path=BindingContext.DeleteSwipedRowCommand}"
                                                            CommandParameter="{Binding .}"
                                                            Text="Eliminar" />
                                                        <SwipeItem
                                                            BackgroundColor="LightGreen"
                                                            Command="{Binding Source={x:Reference mainpage}, Path=BindingContext.ReplaceSwipedRowCommand}"
                                                            CommandParameter="{Binding .}"
                                                            Text="Reemplazar" />
                                                    </SwipeItems>
                                                </SwipeView.LeftItems>
                                                <Grid Padding="10">
                                                    <Grid.GestureRecognizers>
                                                        <TapGestureRecognizer Command="{Binding Source={x:Reference myCollectionView}, Path=BindingContext.LoadTappedExerciseCommand}" CommandParameter="{Binding Exercise}" />
                                                    </Grid.GestureRecognizers>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <Image
                                                        Grid.Row="1"
                                                        Margin="0,20,0,0"
                                                        HeightRequest="50"
                                                        Source="{Binding Urls[0]}"
                                                        WidthRequest="50" />
                                                    <!--  TextColor="{Binding Path=BindingContext.ExerciseListColor, Source={x:Reference mainpage}}"  -->
                                                    <Label
                                                        Grid.Column="1"
                                                        Text="{Binding Exercise.Name}"
                                                        VerticalOptions="Center">
                                                        <Label.Triggers>
                                                            <DataTrigger
                                                                Binding="{Binding Path=BindingContext.IsExerciseFinished, Source={x:Reference mainpage}}"
                                                                TargetType="Label"
                                                                Value="True">
                                                                <Setter Property="TextColor" Value="LightGreen" />
                                                            </DataTrigger>
                                                            <DataTrigger
                                                                Binding="{Binding Path=BindingContext.IsExerciseFinished, Source={x:Reference mainpage}}"
                                                                TargetType="Label"
                                                                Value="False">
                                                                <Setter Property="TextColor" Value="Black" />
                                                            </DataTrigger>
                                                        </Label.Triggers>
                                                    </Label>
                                                </Grid>

                                            </SwipeView>

                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>
                                </CollectionView>

                            </ScrollView>

                            <Button
                                Margin="0,20,0,0"
                                Command="{Binding LoadStartedWorkoutCommand}"
                                CommandParameter="{Binding ExerciseList}"
                                HeightRequest="40"
                                Text="Start"
                                VerticalOptions="End"
                                WidthRequest="80" />
                        </VerticalStackLayout>
                    </ScrollView>
                </tabView:SfTabItem.Content>
            </tabView:SfTabItem>

            <!--  TAB NUMBER THREE  -->
            <tabView:SfTabItem Header="Entrenamientos">
                <tabView:SfTabItem.Content>
                    <ScrollView>

                        <VerticalStackLayout>
                            <Label
                                FontAttributes="Bold"
                                FontFamily="Times New Roman"
                                FontSize="25"
                                HorizontalOptions="Center"
                                Text="Mis Entrenamientos" />
                            <!--<Button
                            Command="{Binding GetSessionExercisesCommand}"
                            Text="Get"
                            WidthRequest="100" />-->
                            <accordion:SfAccordion
                                x:Name="myAccordionItem"
                                Margin="0,20,0,0"
                                AnimationDuration="250"
                                AnimationEasing="SinInOut"
                                ExpandMode="SingleOrNone">
                                <accordion:SfAccordion.Items>
                                    <accordion:AccordionItem>
                                        <accordion:AccordionItem.Header>
                                            <Grid>
                                                <Label Text="Train:" VerticalOptions="Center" />
                                                <Label
                                                    Margin="40,0,0,0"
                                                    Text="{Binding ExerciseView.FechaEntrenamiento}"
                                                    VerticalOptions="Center" />
                                                <CheckBox Margin="300,0,0,0" IsChecked="True" />
                                            </Grid>
                                        </accordion:AccordionItem.Header>
                                        <accordion:AccordionItem.Content>
                                            <Grid>
                                                <VerticalStackLayout HeightRequest="600">


                                                    <Border>
                                                        <CollectionView
                                                            x:Name="myExerciseCollection"
                                                            Margin="0,20,0,0"
                                                            HeightRequest="500"
                                                            ItemsSource="{Binding ExerciseSessionlist}">
                                                            <CollectionView.ItemTemplate>
                                                                <DataTemplate x:DataType="models:ExerciseModelView">
                                                                    <SwipeView>
                                                                        <!--<SwipeView.GestureRecognizers>
                                                                        <SwipeGestureRecognizer
                                                                        Command="{Binding Source={x:Reference thisPage}, Path=BindingContext.DeleteSwipedRowCommand}"
                                                                        CommandParameter="{Binding .}"
                                                                        Direction="Right" />
                                                                        </SwipeView.GestureRecognizers>-->

                                                                        <SwipeView.LeftItems>
                                                                            <SwipeItems>
                                                                                <SwipeItem
                                                                                    BackgroundColor="Red"
                                                                                    Command="{Binding Source={x:Reference mainpage}, Path=BindingContext.DeleteCustomTrainingExerciseCommand}"
                                                                                    CommandParameter="{Binding .}"
                                                                                    Text="Eliminar" />
                                                                                <SwipeItem
                                                                                    BackgroundColor="LightGreen"
                                                                                    Command="{Binding Source={x:Reference mainpage}, Path=BindingContext.ReplaceSwipedRowCommand}"
                                                                                    CommandParameter="{Binding .}"
                                                                                    Text="Reemplazar" />
                                                                            </SwipeItems>
                                                                        </SwipeView.LeftItems>
                                                                        <Grid>
                                                                            <Grid.GestureRecognizers>
                                                                                <TapGestureRecognizer Command="{Binding Source={x:Reference myExerciseCollection}, Path=BindingContext.ExerciseTappedCommand}" CommandParameter="{Binding}" />
                                                                            </Grid.GestureRecognizers>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="Auto" />
                                                                                <ColumnDefinition Width="*" />
                                                                                <ColumnDefinition Width="Auto" />
                                                                                <ColumnDefinition Width="Auto" />
                                                                            </Grid.ColumnDefinitions>
                                                                            <Image
                                                                                Grid.Row="1"
                                                                                Margin="0,20,0,0"
                                                                                HeightRequest="50"
                                                                                Source="{Binding Urls[0]}"
                                                                                WidthRequest="50" />
                                                                            <Label
                                                                                Grid.Column="1"
                                                                                Text="{Binding Name}"
                                                                                VerticalOptions="Center" />
                                                                            <Label
                                                                                Grid.Column="2"
                                                                                Text="{Binding FechaEntrenamiento}"
                                                                                VerticalOptions="Center" />
                                                                            <CheckBox
                                                                                Grid.Column="3"
                                                                                HeightRequest="100"
                                                                                IsChecked="{Binding IsChecked}" />
                                                                        </Grid>
                                                                    </SwipeView>
                                                                </DataTemplate>
                                                            </CollectionView.ItemTemplate>
                                                        </CollectionView>

                                                    </Border>
                                                </VerticalStackLayout>
                                            </Grid>
                                        </accordion:AccordionItem.Content>
                                    </accordion:AccordionItem>
                                </accordion:SfAccordion.Items>
                            </accordion:SfAccordion>

                            <VerticalStackLayout Margin="0,20,0,0">
                                <HorizontalStackLayout HorizontalOptions="Center" Spacing="20">
                                    <Button
                                        Background="Red"
                                        Command="{Binding DeleteSelectedExerciseCommand}"
                                        IsVisible="{Binding IsDeleteExerciseButtonVisible}"
                                        Text="Borrar"
                                        WidthRequest="100" />
                                    <Button
                                        Background="Red"
                                        Command="{Binding DeleteSessionCommand}"
                                        IsVisible="{Binding IsDeleteExerciseButtonVisible}"
                                        Text="Borrar Todo"
                                        WidthRequest="150" />
                                </HorizontalStackLayout>

                            </VerticalStackLayout>

                        </VerticalStackLayout>
                    </ScrollView>
                </tabView:SfTabItem.Content>
            </tabView:SfTabItem>
        </tabView:SfTabView.Items>
    </tabView:SfTabView>


</ContentPage>
